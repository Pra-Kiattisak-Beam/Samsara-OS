<!DOCTYPE html>
<html lang="th">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Paticcasamuppada OS - V1</title>
    <script src="https://cdn.tailwindcss.com"></script>
    <script src="https://unpkg.com/lucide@latest"></script>
    <link href="https://fonts.googleapis.com/css2?family=Chakra+Petch:wght@300;400;500;600;700&display=swap" rel="stylesheet">
    <style>
        body {
            font-family: 'Chakra Petch', sans-serif;
            background-color: #0f172a;
            min-height: 100vh;
            overflow-y: auto; 
            overflow-x: hidden;
            color: #cbd5e1;
            user-select: none;
        }

        .zen-panel {
            background: rgba(30, 41, 59, 0.4);
            backdrop-filter: blur(16px);
            border: 1px solid rgba(255, 255, 255, 0.1);
            border-radius: 16px;
        }

        .zen-active {
            background: rgba(255, 255, 255, 0.15);
            border-color: rgba(255, 255, 255, 0.5);
            box-shadow: 0 0 30px rgba(255, 255, 255, 0.15);
            transform: scale(1.03);
            z-index: 20;
        }

        /* Mode Highlights */
        .highlight-LOOP { border-left: 3px solid #eab308; } 
        .highlight-INTERNAL { border-left: 3px solid #f97316; } 
        .highlight-GATEWAY { border-left: 3px solid #06b6d4; } 
        .highlight-VEDANA { border-left: 3px solid #8b5cf6; } 
        .highlight-TANHA { border-left: 3px solid #ef4444; } 
        .highlight-VOID { border-left: 3px solid #ffffff; }

        .nav-btn {
            padding: 6px 12px;
            border-radius: 99px;
            font-size: 10px;
            font-weight: 600;
            transition: all 0.3s ease;
            opacity: 0.6;
            background: transparent;
            border: 1px solid transparent;
            white-space: nowrap;
        }
        .nav-btn:hover { opacity: 0.9; background: rgba(255,255,255,0.05); }
        .nav-btn.active {
            opacity: 1;
            background: rgba(30, 41, 59, 0.9);
            border-color: rgba(255,255,255,0.2);
            box-shadow: 0 4px 12px rgba(0,0,0,0.3);
        }

        .progress-bar {
            height: 2px;
            background: currentColor;
            width: 0%;
            transition: width 0.1s linear;
        }

        /* Mode Info Collapse Animation */
        .mode-info-container {
            transition: all 0.8s cubic-bezier(0.4, 0, 0.2, 1);
            overflow: hidden;
            max-height: 150px;
            opacity: 1;
            margin-bottom: 0.75rem;
        }
        .mode-info-container.collapsed {
            max-height: 0;
            opacity: 0;
            margin-bottom: 0;
            padding-top: 0;
            padding-bottom: 0;
            border-width: 0;
        }

        .scenario-select {
            background: rgba(15, 23, 42, 0.6);
            border: 1px solid rgba(255,255,255,0.1);
            color: #94a3b8;
            font-size: 11px;
            padding: 4px 8px;
            border-radius: 8px;
            outline: none;
            cursor: pointer;
        }
        .scenario-select:focus { border-color: #eab308; color: white; }

        /* Modal Styles */
        .modal-overlay {
            position: fixed; top: 0; left: 0; width: 100%; height: 100%;
            background: rgba(0,0,0,0.8); backdrop-filter: blur(5px);
            z-index: 50; display: none; justify-content: center; align-items: center;
            opacity: 0; transition: opacity 0.3s ease;
        }
        .modal-overlay.open { display: flex; opacity: 1; }
        .modal-content {
            background: #1e293b; border: 1px solid rgba(255,255,255,0.1);
            border-radius: 16px; width: 90%; max-width: 400px; padding: 20px;
            transform: scale(0.9); transition: transform 0.3s ease;
        }
        .modal-overlay.open .modal-content { transform: scale(1); }

        /* Custom Scrollbar */
        ::-webkit-scrollbar { width: 6px; height: 6px; }
        ::-webkit-scrollbar-track { background: rgba(0,0,0,0.2); }
        ::-webkit-scrollbar-thumb { background: rgba(255,255,255,0.2); border-radius: 4px; }
        ::-webkit-scrollbar-thumb:hover { background: rgba(255,255,255,0.4); }
    </style>
</head>
<body class="flex flex-col p-3 md:p-4 gap-3">

    <!-- Header -->
    <header class="flex flex-col xl:flex-row justify-between items-center gap-3 shrink-0">
        <div class="flex items-center gap-2 w-full xl:w-auto justify-between xl:justify-start">
            <div class="flex items-center gap-2">
                <div id="mode-dot" class="w-2.5 h-2.5 rounded-full bg-yellow-500 shadow-[0_0_10px_currentColor] transition-colors duration-500"></div>
                <h1 class="text-lg font-bold text-white tracking-wide leading-none uppercase">
                    Paticcasamuppada OS <span class="text-slate-300 font-normal ml-1 text-sm">‡∏õ‡∏è‡∏¥‡∏à‡∏à‡∏™‡∏°‡∏∏‡∏õ‡∏ö‡∏≤‡∏ó</span>
                    <span class="text-[9px] text-slate-500 border border-slate-700 px-1.5 py-0.5 rounded ml-2">V1</span>
                </h1>
            </div>
            
            <!-- Scenario Selector & AI Button -->
            <div class="flex items-center gap-2 xl:ml-4">
                <select id="scenario-select" onchange="changeScenario(this.value)" class="scenario-select">
                    <option value="NONE">-- ‡∏™‡∏ñ‡∏≤‡∏ô‡∏Å‡∏≤‡∏£‡∏ì‡πå‡∏ó‡∏±‡πà‡∏ß‡πÑ‡∏õ --</option>
                    <option value="FOOD">üçó ‡πÄ‡∏£‡∏∑‡πà‡∏≠‡∏á‡∏Å‡∏¥‡∏ô</option>
                    <option value="SOCIAL">üì± ‡πÇ‡∏ã‡πÄ‡∏ä‡∏µ‡∏¢‡∏•</option>
                    <option value="SHOPPING">üõçÔ∏è ‡∏ä‡πâ‡∏≠‡∏õ‡∏õ‡∏¥‡πâ‡∏á</option>
                    <option value="CUSTOM" hidden>‚ú® ‡πÄ‡∏£‡∏∑‡πà‡∏≠‡∏á‡∏Ç‡∏≠‡∏á‡∏Ñ‡∏∏‡∏ì...</option>
                </select>
                <button onclick="openAIModal()" class="nav-btn bg-emerald-900/30 text-emerald-400 border-emerald-500/30 hover:bg-emerald-500/20 active:bg-emerald-500/30 flex items-center gap-1 shadow-[0_0_10px_rgba(16,185,129,0.2)]">
                    <i data-lucide="sparkles" class="w-3 h-3"></i> AI Analyze
                </button>
            </div>
        </div>
        
        <!-- Mode Buttons -->
        <div class="flex gap-1 bg-slate-900/60 p-1 rounded-full border border-white/10 overflow-x-auto max-w-full shadow-lg w-full xl:w-auto pb-2 md:pb-1">
            <button onclick="setMode('LOOP')" id="btn-LOOP" class="nav-btn text-yellow-400">‡∏ß‡∏±‡∏è‡∏è‡∏∞</button>
            <button onclick="setMode('INTERNAL')" id="btn-INTERNAL" class="nav-btn text-orange-400">‡∏´‡∏¢‡∏∏‡∏î‡∏õ‡∏£‡∏∏‡∏á‡πÅ‡∏ï‡πà‡∏á</button>
            <button onclick="setMode('GATEWAY')" id="btn-GATEWAY" class="nav-btn text-cyan-400">‡∏™‡∏±‡∏Å‡πÅ‡∏ï‡πà‡∏ß‡πà‡∏≤‡∏£‡∏π‡πâ</button>
            <button onclick="setMode('VEDANA')" id="btn-VEDANA" class="nav-btn text-purple-400">‡∏£‡∏π‡πâ‡∏ó‡∏±‡∏ô‡πÄ‡∏ß‡∏ó‡∏ô‡∏≤</button>
            <button onclick="setMode('TANHA')" id="btn-TANHA" class="nav-btn text-red-400">‡∏î‡∏±‡∏ö‡∏ï‡∏±‡∏ì‡∏´‡∏≤</button>
            <button onclick="setMode('VOID')" id="btn-VOID" class="nav-btn text-white">‡∏™‡∏•‡∏±‡∏î‡∏Ñ‡∏∑‡∏ô</button>
        </div>
    </header>

    <!-- Main Content -->
    <div class="flex-1 grid grid-cols-1 lg:grid-cols-12 gap-4">
        
        <!-- Left: Grid Cards -->
        <div id="grid-container" class="lg:col-span-7 grid grid-cols-2 md:grid-cols-3 gap-2 min-h-[400px]">
            <!-- Cards injected by JS -->
        </div>

        <!-- Right: Detail Panel -->
        <div class="lg:col-span-5 flex flex-col gap-0 relative">
            
            <!-- 1. Mode Objective -->
            <div id="mode-info-box" class="mode-info-container zen-panel border-l-4 p-3 shrink-0">
                <div class="flex justify-between items-start mb-1">
                    <span class="text-[9px] font-mono uppercase tracking-widest text-slate-400">‡∏ß‡∏±‡∏ï‡∏ñ‡∏∏‡∏õ‡∏£‡∏∞‡∏™‡∏á‡∏Ñ‡πå (Objective)</span>
                    <span id="toast-timer" class="text-[9px] text-slate-500 animate-pulse">Auto-hide</span>
                </div>
                <h3 id="mode-title" class="text-sm font-bold text-white mb-1">...</h3>
                <p id="mode-desc" class="text-[11px] text-slate-300 leading-relaxed font-light">...</p>
            </div>

            <!-- 2. Active Card Detail -->
            <div class="zen-panel p-5 md:p-6 flex flex-col relative overflow-hidden group min-h-[500px]">
                <div id="bg-icon-decor" class="absolute -right-6 -bottom-6 opacity-[0.05] transition-all duration-700 transform group-hover:scale-110 group-hover:rotate-12"></div>

                <div class="z-10 flex flex-col h-full">
                    
                    <!-- Title Header -->
                    <div class="mb-4 shrink-0">
                         <div class="flex justify-between items-start">
                             <div class="text-[10px] font-mono text-blue-400 mb-1 uppercase tracking-wider" id="active-tech-label">ROOT ERROR</div>
                             <div id="pid-display" class="text-xs font-mono text-slate-600 font-bold">01/12</div>
                         </div>
                         <h2 id="active-pali" class="text-3xl md:text-4xl font-bold text-white transition-all duration-300 leading-tight">...</h2>
                    </div>

                    <div class="h-px w-full bg-white/10 mb-4 shrink-0"></div>

                    <!-- Scrollable Content Area -->
                    <div class="flex-1 space-y-4 overflow-y-auto custom-scroll pr-2">
                        
                        <!-- Scenario Box (Visible if scenario selected) -->
                        <div id="scenario-box" class="hidden bg-green-900/20 rounded-xl p-4 border border-green-500/20 hover:bg-green-900/30 transition-colors animate-pulse-once">
                            <div class="text-[11px] font-bold text-green-400 uppercase mb-2 flex items-center gap-2">
                                <i data-lucide="sparkles" class="w-4 h-4 text-emerald-400"></i>
                                <span id="label-scenario">‡∏™‡∏ñ‡∏≤‡∏ô‡∏Å‡∏≤‡∏£‡∏ì‡πå‡∏ï‡∏±‡∏ß‡∏≠‡∏¢‡πà‡∏≤‡∏á</span>
                            </div>
                            <p id="active-scenario" class="text-sm text-green-100 font-normal leading-relaxed">...</p>
                        </div>

                        <!-- Dhamma Block -->
                        <div class="bg-black/20 rounded-xl p-4 border border-white/5 hover:bg-black/30 transition-colors">
                            <div class="text-[11px] font-bold text-slate-300 uppercase mb-2 flex items-center gap-2">
                                <i data-lucide="book-open" class="w-4 h-4 text-yellow-500"></i>
                                <span id="label-dhamma">‡∏Ñ‡∏ß‡∏≤‡∏°‡∏´‡∏°‡∏≤‡∏¢‡∏ó‡∏≤‡∏á‡∏ò‡∏£‡∏£‡∏°</span>
                            </div>
                            <p id="active-dhamma" class="text-sm text-slate-200 font-light leading-relaxed">...</p>
                        </div>

                        <!-- Analogy Block -->
                        <div class="bg-blue-500/5 rounded-xl p-4 border border-blue-500/10 hover:bg-blue-500/10 transition-colors">
                            <div class="text-[11px] font-bold text-blue-300 uppercase mb-2 flex items-center gap-2">
                                <i data-lucide="monitor" class="w-4 h-4" id="icon-analogy"></i>
                                <span id="label-analogy">‡πÄ‡∏õ‡∏£‡∏µ‡∏¢‡∏ö‡πÄ‡∏ó‡∏µ‡∏¢‡∏ö‡∏ó‡∏≤‡∏á‡πÄ‡∏ó‡∏Ñ‡∏ô‡∏¥‡∏Ñ</span>
                            </div>
                            <div id="active-analogy" class="text-xs md:text-sm text-blue-100/90 font-light leading-relaxed whitespace-pre-line">...</div>
                        </div>

                    </div>

                    <!-- Progress Bar -->
                    <div class="mt-4 pt-3 border-t border-white/5 relative shrink-0">
                        <div class="absolute bottom-0 left-0 w-full h-1 bg-white/5 rounded-full overflow-hidden">
                            <div id="main-progress" class="progress-bar bg-white"></div>
                        </div>
                    </div>
                </div>
            </div>

        </div>
    </div>

    <!-- AI Input Modal -->
    <div id="ai-modal" class="modal-overlay">
        <div class="modal-content">
            <div class="flex justify-between items-center mb-4">
                <h3 class="text-lg font-bold text-white flex items-center gap-2"><i data-lucide="sparkles" class="w-5 h-5 text-emerald-400"></i> ‡∏ß‡∏¥‡πÄ‡∏Ñ‡∏£‡∏≤‡∏∞‡∏´‡πå‡∏î‡πâ‡∏ß‡∏¢ AI</h3>
                <button onclick="closeAIModal()" class="text-slate-400 hover:text-white"><i data-lucide="x" class="w-5 h-5"></i></button>
            </div>
            <p class="text-sm text-slate-400 mb-3">‡∏û‡∏¥‡∏°‡∏û‡πå‡πÄ‡∏£‡∏∑‡πà‡∏≠‡∏á‡∏£‡∏≤‡∏ß‡∏´‡∏£‡∏∑‡∏≠‡∏õ‡∏±‡∏ç‡∏´‡∏≤‡∏ó‡∏µ‡πà‡∏Å‡∏≥‡∏•‡∏±‡∏á‡πÄ‡∏ú‡∏ä‡∏¥‡∏ç‡∏≠‡∏¢‡∏π‡πà AI ‡∏à‡∏∞‡∏ä‡πà‡∏ß‡∏¢‡πÅ‡∏à‡∏Å‡πÅ‡∏à‡∏á‡∏ï‡∏≤‡∏°‡∏´‡∏•‡∏±‡∏Å‡∏õ‡∏è‡∏¥‡∏à‡∏à‡∏™‡∏°‡∏∏‡∏õ‡∏ö‡∏≤‡∏ó‡πÉ‡∏´‡πâ‡∏Ñ‡∏£‡∏±‡∏ö</p>
            <textarea id="ai-input" rows="3" class="w-full bg-slate-900 border border-slate-700 rounded-lg p-3 text-sm text-white focus:border-emerald-500 outline-none resize-none mb-4 placeholder-slate-600" placeholder="‡∏ï‡∏±‡∏ß‡∏≠‡∏¢‡πà‡∏≤‡∏á: ‡∏ú‡∏°‡πÇ‡∏Å‡∏£‡∏ò‡πÄ‡∏û‡∏∑‡πà‡∏≠‡∏ô‡∏£‡πà‡∏ß‡∏°‡∏á‡∏≤‡∏ô‡∏ó‡∏µ‡πà‡∏û‡∏π‡∏î‡∏à‡∏≤‡πÑ‡∏°‡πà‡∏î‡∏µ‡πÉ‡∏™‡πà, ‡∏≠‡∏¢‡∏≤‡∏Å‡πÄ‡∏•‡∏¥‡∏Å‡∏Å‡∏¥‡∏ô‡∏ä‡∏≤‡∏ô‡∏°‡πÑ‡∏Ç‡πà‡∏°‡∏∏‡∏Å, ‡πÄ‡∏Ñ‡∏£‡∏µ‡∏¢‡∏î‡πÄ‡∏£‡∏∑‡πà‡∏≠‡∏á‡∏´‡∏ô‡∏µ‡πâ‡∏™‡∏¥‡∏ô"></textarea>
            
            <div class="flex justify-end gap-2">
                <button onclick="closeAIModal()" class="px-4 py-2 rounded-lg text-sm text-slate-400 hover:bg-slate-800">‡∏¢‡∏Å‡πÄ‡∏•‡∏¥‡∏Å</button>
                <button onclick="submitAI()" id="ai-submit-btn" class="px-4 py-2 rounded-lg text-sm bg-emerald-600 text-white hover:bg-emerald-500 font-bold flex items-center gap-2">
                    <i data-lucide="brain-circuit" class="w-4 h-4"></i> ‡∏ß‡∏¥‡πÄ‡∏Ñ‡∏£‡∏≤‡∏∞‡∏´‡πå
                </button>
            </div>
        </div>
    </div>

    <script>
        const apiKey = "AIzaSyBnnrMg7VWfpalIa48VjBai2SvJ97qzi30"; // API Key injected by environment

        const nidanas = [
            { 
                id: 1, pali: "‡∏≠‡∏ß‡∏¥‡∏ä‡∏ä‡∏≤", tech: "Root Bug", icon: "shield-alert", 
                dhamma: "‡∏Ñ‡∏ß‡∏≤‡∏°‡πÑ‡∏°‡πà‡∏£‡∏π‡πâ‡πÅ‡∏à‡πâ‡∏á‡∏ï‡∏≤‡∏°‡∏Ñ‡∏ß‡∏≤‡∏°‡πÄ‡∏õ‡πá‡∏ô‡∏à‡∏£‡∏¥‡∏á ‡πÑ‡∏°‡πà‡∏£‡∏π‡πâ‡∏ß‡πà‡∏≤‡∏ó‡∏∏‡∏Å‡∏™‡∏¥‡πà‡∏á‡πÑ‡∏°‡πà‡πÄ‡∏ó‡∏µ‡πà‡∏¢‡∏á", 
                analogy: "‡πÄ‡∏´‡∏°‡∏∑‡∏≠‡∏ô OS ‡πÄ‡∏ñ‡∏∑‡πà‡∏≠‡∏ô‡∏ó‡∏µ‡πà‡∏°‡∏µ Bug ‡∏ù‡∏±‡∏á‡∏•‡∏∂‡∏Å ‡∏ó‡∏≥‡πÉ‡∏´‡πâ‡∏£‡∏∞‡∏ö‡∏ö‡∏£‡∏ß‡∏ô",
                scenarios: {
                    FOOD: "‡∏´‡∏•‡∏á‡∏Ñ‡∏¥‡∏î‡∏ß‡πà‡∏≤‡∏Å‡∏≤‡∏£‡∏Å‡∏¥‡∏ô‡∏Ç‡∏≠‡∏á‡∏≠‡∏£‡πà‡∏≠‡∏¢‡∏Ñ‡∏∑‡∏≠‡∏Ñ‡∏ß‡∏≤‡∏°‡∏™‡∏∏‡∏Ç‡∏ó‡∏µ‡πà‡πÅ‡∏ó‡πâ‡∏à‡∏£‡∏¥‡∏á‡πÅ‡∏•‡∏∞‡∏¢‡∏±‡πà‡∏á‡∏¢‡∏∑‡∏ô (‡πÑ‡∏°‡πà‡∏£‡∏π‡πâ‡πÇ‡∏ó‡∏©)",
                    SOCIAL: "‡∏´‡∏•‡∏á‡∏¢‡∏∂‡∏î‡∏ß‡πà‡∏≤‡∏Ñ‡∏≥‡∏î‡πà‡∏≤‡πÉ‡∏ô‡∏à‡∏≠‡∏Ñ‡∏∑‡∏≠‡πÄ‡∏£‡∏∑‡πà‡∏≠‡∏á‡∏à‡∏£‡∏¥‡∏á‡∏ó‡∏µ‡πà‡∏ó‡∏≥‡∏£‡πâ‡∏≤‡∏¢‡∏ï‡∏±‡∏ß‡πÄ‡∏£‡∏≤‡πÑ‡∏î‡πâ (‡πÑ‡∏°‡πà‡∏£‡∏π‡πâ‡∏™‡∏°‡∏°‡∏ï‡∏¥)",
                    SHOPPING: "‡∏´‡∏•‡∏á‡πÄ‡∏ä‡∏∑‡πà‡∏≠‡πÇ‡∏Ü‡∏©‡∏ì‡∏≤‡∏ß‡πà‡∏≤‡∏ñ‡πâ‡∏≤‡πÑ‡∏î‡πâ‡∏Ç‡∏≠‡∏á‡∏ä‡∏¥‡πâ‡∏ô‡∏ô‡∏µ‡πâ‡πÅ‡∏•‡πâ‡∏ß‡∏ä‡∏µ‡∏ß‡∏¥‡∏ï‡∏à‡∏∞‡∏™‡∏°‡∏ö‡∏π‡∏£‡∏ì‡πå‡πÅ‡∏ö‡∏ö (‡∏´‡∏•‡∏á Marketing)",
                    CUSTOM: ""
                }
            },
            { 
                id: 2, pali: "‡∏™‡∏±‡∏á‡∏Ç‡∏≤‡∏£", tech: "Programming", icon: "activity", 
                dhamma: "‡∏Å‡∏≤‡∏£‡∏õ‡∏£‡∏∏‡∏á‡πÅ‡∏ï‡πà‡∏á‡∏Ñ‡∏ß‡∏≤‡∏°‡∏Ñ‡∏¥‡∏î/‡πÄ‡∏à‡∏ï‡∏ô‡∏≤ (‡∏Å‡∏£‡∏£‡∏°)", 
                analogy: "‡πÄ‡∏´‡∏°‡∏∑‡∏≠‡∏ô Programmer ‡πÄ‡∏Ç‡∏µ‡∏¢‡∏ô Code ‡∏™‡∏±‡πà‡∏á‡∏á‡∏≤‡∏ô‡∏ú‡∏¥‡∏î‡πÜ ‡∏•‡∏á‡πÑ‡∏õ",
                scenarios: {
                    FOOD: "‡πÉ‡∏à‡πÄ‡∏£‡∏¥‡πà‡∏°‡∏Ñ‡∏¥‡∏î‡∏õ‡∏£‡∏∏‡∏á‡πÅ‡∏ï‡πà‡∏á‡∏ß‡πà‡∏≤ '‡πÄ‡∏¢‡πá‡∏ô‡∏ô‡∏µ‡πâ‡∏ï‡πâ‡∏≠‡∏á‡∏Å‡∏¥‡∏ô‡πÑ‡∏Å‡πà‡∏ó‡∏≠‡∏î‡∏£‡πâ‡∏≤‡∏ô‡∏ô‡∏±‡πâ‡∏ô‡πÉ‡∏´‡πâ‡πÑ‡∏î‡πâ'",
                    SOCIAL: "‡πÉ‡∏à‡πÄ‡∏£‡∏¥‡πà‡∏°‡∏Ñ‡∏¥‡∏î‡∏Ñ‡∏≥‡∏î‡πà‡∏≤‡∏Å‡∏•‡∏±‡∏ö ‡πÄ‡∏£‡∏¥‡πà‡∏°‡∏ú‡∏π‡∏Å‡πÉ‡∏à‡πÄ‡∏à‡πá‡∏ö ‡∏õ‡∏£‡∏∏‡∏á‡πÅ‡∏ï‡πà‡∏á‡∏Ñ‡∏ß‡∏≤‡∏°‡πÇ‡∏Å‡∏£‡∏ò",
                    SHOPPING: "‡πÉ‡∏à‡πÄ‡∏£‡∏¥‡πà‡∏°‡∏ß‡∏≤‡∏á‡πÅ‡∏ú‡∏ô‡∏Å‡∏≤‡∏£‡πÄ‡∏á‡∏¥‡∏ô ‡∏Ñ‡∏≥‡∏ô‡∏ß‡∏ì‡∏Ñ‡∏ß‡∏≤‡∏°‡∏Ñ‡∏∏‡πâ‡∏°‡∏Ñ‡πà‡∏≤‡πÄ‡∏Ç‡πâ‡∏≤‡∏Ç‡πâ‡∏≤‡∏á‡∏ï‡∏±‡∏ß‡πÄ‡∏≠‡∏á",
                    CUSTOM: ""
                }
            },
            { 
                id: 3, pali: "‡∏ß‡∏¥‡∏ç‡∏ç‡∏≤‡∏ì", tech: "System Boot", icon: "cpu", 
                dhamma: "‡∏Å‡∏≤‡∏£‡∏£‡∏±‡∏ö‡∏£‡∏π‡πâ‡∏≠‡∏≤‡∏£‡∏°‡∏ì‡πå (‡∏ò‡∏≤‡∏ï‡∏∏‡∏£‡∏π‡πâ)", 
                analogy: "‡πÄ‡∏´‡∏°‡∏∑‡∏≠‡∏ô‡∏Å‡∏î‡∏õ‡∏∏‡πà‡∏°‡πÄ‡∏õ‡∏¥‡∏î‡πÄ‡∏Ñ‡∏£‡∏∑‡πà‡∏≠‡∏á ‡∏£‡∏∞‡∏ö‡∏ö‡∏ï‡∏∑‡πà‡∏ô‡∏ï‡∏±‡∏ß‡∏û‡∏£‡πâ‡∏≠‡∏°‡∏£‡∏±‡∏ö Input",
                scenarios: {
                    FOOD: "‡∏à‡∏¥‡∏ï‡∏ï‡∏∑‡πà‡∏ô‡∏ï‡∏±‡∏ß‡∏£‡∏±‡∏ö‡∏£‡∏π‡πâ‡∏Ñ‡∏ß‡∏≤‡∏°‡∏´‡∏¥‡∏ß‡πÅ‡∏•‡∏∞‡∏Ñ‡∏ß‡∏≤‡∏°‡∏≠‡∏¢‡∏≤‡∏Å ‡πÄ‡∏ï‡∏£‡∏µ‡∏¢‡∏°‡∏û‡∏∏‡πà‡∏á‡πÑ‡∏õ‡∏´‡∏≤‡∏£‡πâ‡∏≤‡∏ô",
                    SOCIAL: "‡∏à‡∏¥‡∏ï‡∏à‡∏î‡∏à‡πà‡∏≠‡∏≠‡∏¢‡∏π‡πà‡∏Å‡∏±‡∏ö‡∏´‡∏ô‡πâ‡∏≤‡∏à‡∏≠‡∏°‡∏∑‡∏≠‡∏ñ‡∏∑‡∏≠ ‡πÄ‡∏ï‡∏£‡∏µ‡∏¢‡∏°‡∏û‡∏£‡πâ‡∏≠‡∏°‡∏õ‡∏∞‡∏ó‡∏∞",
                    SHOPPING: "‡∏à‡∏¥‡∏ï‡∏û‡∏∏‡πà‡∏á‡πÑ‡∏õ‡πÄ‡∏Å‡∏≤‡∏∞‡∏≠‡∏¢‡∏π‡πà‡∏ó‡∏µ‡πà‡∏™‡∏¥‡∏ô‡∏Ñ‡πâ‡∏≤‡∏ä‡∏¥‡πâ‡∏ô‡∏ô‡∏±‡πâ‡∏ô ‡∏£‡∏±‡∏ö‡∏£‡∏π‡πâ‡πÅ‡∏ï‡πà‡πÄ‡∏£‡∏∑‡πà‡∏≠‡∏á‡∏Ç‡∏≠‡∏á‡∏°‡∏±‡∏ô",
                    CUSTOM: ""
                }
            },
            { 
                id: 4, pali: "‡∏ô‡∏≤‡∏°‡∏£‡∏π‡∏õ", tech: "Hardware/Software", icon: "layers", 
                dhamma: "‡∏Å‡∏≤‡∏¢‡πÅ‡∏•‡∏∞‡πÉ‡∏à‡∏ó‡∏≥‡∏á‡∏≤‡∏ô‡∏£‡πà‡∏ß‡∏°‡∏Å‡∏±‡∏ô", 
                analogy: "‡πÄ‡∏´‡∏°‡∏∑‡∏≠‡∏ô Hardware ‡πÅ‡∏•‡∏∞ Software ‡∏ó‡∏≥‡∏á‡∏≤‡∏ô‡∏õ‡∏£‡∏∞‡∏™‡∏≤‡∏ô‡∏Å‡∏±‡∏ô",
                scenarios: {
                    FOOD: "‡∏ó‡πâ‡∏≠‡∏á‡∏£‡πâ‡∏≠‡∏á (‡∏£‡∏π‡∏õ) ‡πÅ‡∏•‡∏∞‡πÉ‡∏à‡∏ó‡∏µ‡πà‡∏´‡∏¥‡∏ß‡πÇ‡∏´‡∏¢ (‡∏ô‡∏≤‡∏°) ‡∏ó‡∏≥‡∏á‡∏≤‡∏ô‡∏™‡∏≠‡∏î‡∏Ñ‡∏•‡πâ‡∏≠‡∏á‡∏Å‡∏±‡∏ô",
                    SOCIAL: "‡∏°‡∏∑‡∏≠‡∏ñ‡∏∑‡∏≠‡πÇ‡∏ó‡∏£‡∏®‡∏±‡∏û‡∏ó‡πå (‡∏£‡∏π‡∏õ) ‡πÅ‡∏•‡∏∞‡πÉ‡∏à‡∏ó‡∏µ‡πà‡∏£‡πâ‡∏≠‡∏ô‡∏£‡∏∏‡πà‡∏° (‡∏ô‡∏≤‡∏°) ‡∏û‡∏£‡πâ‡∏≠‡∏°‡∏ó‡∏≥‡∏á‡∏≤‡∏ô",
                    SHOPPING: "‡∏ï‡∏≤‡∏à‡πâ‡∏≠‡∏á‡∏™‡∏¥‡∏ô‡∏Ñ‡πâ‡∏≤ (‡∏£‡∏π‡∏õ) ‡πÅ‡∏•‡∏∞‡πÉ‡∏à‡∏ó‡∏µ‡πà‡∏ï‡∏∑‡πà‡∏ô‡πÄ‡∏ï‡πâ‡∏ô (‡∏ô‡∏≤‡∏°) ‡∏õ‡∏£‡∏∞‡∏™‡∏≤‡∏ô‡∏á‡∏≤‡∏ô‡∏Å‡∏±‡∏ô",
                    CUSTOM: ""
                }
            },
            { 
                id: 5, pali: "‡∏™‡∏¨‡∏≤‡∏¢‡∏ï‡∏ô‡∏∞", tech: "I/O Ports", icon: "eye", 
                dhamma: "‡∏ä‡πà‡∏≠‡∏á‡∏ó‡∏≤‡∏á‡∏£‡∏±‡∏ö‡∏™‡∏±‡∏°‡∏ú‡∏±‡∏™ (‡∏ï‡∏≤ ‡∏´‡∏π ‡∏à‡∏°‡∏π‡∏Å...)", 
                analogy: "‡πÄ‡∏´‡∏°‡∏∑‡∏≠‡∏ô Port ‡πÄ‡∏ä‡∏∑‡πà‡∏≠‡∏°‡∏ï‡πà‡∏≠‡∏ó‡∏µ‡πà‡πÄ‡∏õ‡∏¥‡∏î‡∏£‡∏≠‡∏£‡∏±‡∏ö‡∏™‡∏±‡∏ç‡∏ç‡∏≤‡∏ì",
                scenarios: {
                    FOOD: "‡∏à‡∏°‡∏π‡∏Å‡πÄ‡∏õ‡∏¥‡∏î‡∏£‡∏±‡∏ö‡∏Å‡∏•‡∏¥‡πà‡∏ô ‡∏•‡∏¥‡πâ‡∏ô‡πÄ‡∏ï‡∏£‡∏µ‡∏¢‡∏°‡∏£‡∏±‡∏ö‡∏£‡∏™ ‡∏ï‡∏≤‡∏î‡∏π‡πÄ‡∏°‡∏ô‡∏π",
                    SOCIAL: "‡∏ï‡∏≤‡∏à‡πâ‡∏≠‡∏á‡∏ï‡∏±‡∏ß‡∏´‡∏ô‡∏±‡∏á‡∏™‡∏∑‡∏≠ ‡∏´‡∏π‡∏£‡∏≠‡∏ü‡∏±‡∏á‡πÄ‡∏™‡∏µ‡∏¢‡∏á‡πÅ‡∏à‡πâ‡∏á‡πÄ‡∏ï‡∏∑‡∏≠‡∏ô",
                    SHOPPING: "‡∏ï‡∏≤‡∏î‡∏π‡∏£‡∏π‡∏õ‡∏™‡∏¥‡∏ô‡∏Ñ‡πâ‡∏≤ ‡∏´‡∏π‡∏ü‡∏±‡∏á‡∏£‡∏µ‡∏ß‡∏¥‡∏ß‡∏õ‡πâ‡∏≤‡∏¢‡∏¢‡∏≤",
                    CUSTOM: ""
                }
            },
            { 
                id: 6, pali: "‡∏ú‡∏±‡∏™‡∏™‡∏∞", tech: "Input Trigger", icon: "zap", 
                dhamma: "‡∏Å‡∏≤‡∏£‡∏Å‡∏£‡∏∞‡∏ó‡∏ö‡∏Å‡∏±‡∏ô‡∏Ç‡∏≠‡∏á ‡∏≠‡∏≤‡∏¢‡∏ï‡∏ô‡∏∞+‡∏ß‡∏±‡∏ï‡∏ñ‡∏∏", 
                analogy: "‡πÄ‡∏´‡∏°‡∏∑‡∏≠‡∏ô Data Packet ‡∏ß‡∏¥‡πà‡∏á‡πÄ‡∏Ç‡πâ‡∏≤‡∏°‡∏≤‡∏ä‡∏ô Port",
                scenarios: {
                    FOOD: "‡∏Å‡∏•‡∏¥‡πà‡∏ô‡πÑ‡∏Å‡πà‡∏ó‡∏≠‡∏î‡∏•‡∏≠‡∏¢‡∏°‡∏≤‡πÄ‡∏ï‡∏∞‡∏à‡∏°‡∏π‡∏Å ‡∏´‡∏£‡∏∑‡∏≠‡πÄ‡∏´‡πá‡∏ô‡∏£‡∏π‡∏õ‡∏≠‡∏≤‡∏´‡∏≤‡∏£‡∏ô‡πà‡∏≤‡∏Å‡∏¥‡∏ô",
                    SOCIAL: "‡∏ï‡∏≤‡πÄ‡∏´‡πá‡∏ô‡∏Ç‡πâ‡∏≠‡∏Ñ‡∏ß‡∏≤‡∏°‡∏Ñ‡∏≠‡∏°‡πÄ‡∏°‡∏ô‡∏ï‡πå‡πÅ‡∏¢‡πà‡πÜ ‡πÄ‡∏î‡πâ‡∏á‡∏Ç‡∏∂‡πâ‡∏ô‡∏°‡∏≤",
                    SHOPPING: "‡∏ï‡∏≤‡πÄ‡∏´‡πá‡∏ô‡∏õ‡πâ‡∏≤‡∏¢ 'Sale 50%' ‡∏´‡∏£‡∏∑‡∏≠‡πÄ‡∏´‡πá‡∏ô‡∏™‡∏¥‡∏ô‡∏Ñ‡πâ‡∏≤‡∏ß‡∏≤‡∏á‡πÇ‡∏ä‡∏ß‡πå‡∏≠‡∏¢‡∏π‡πà",
                    CUSTOM: ""
                }
            },
            { 
                id: 7, pali: "‡πÄ‡∏ß‡∏ó‡∏ô‡∏≤", tech: "Sentiment Score", icon: "heart", 
                dhamma: "‡∏Ñ‡∏ß‡∏≤‡∏°‡∏£‡∏π‡πâ‡∏™‡∏∂‡∏Å ‡∏™‡∏∏‡∏Ç/‡∏ó‡∏∏‡∏Å‡∏Ç‡πå/‡πÄ‡∏â‡∏¢‡πÜ", 
                analogy: "‡πÄ‡∏´‡∏°‡∏∑‡∏≠‡∏ô‡∏£‡∏∞‡∏ö‡∏ö‡πÉ‡∏´‡πâ Rating ‡∏Ç‡πâ‡∏≠‡∏°‡∏π‡∏• (Like/Dislike)",
                scenarios: {
                    FOOD: "‡∏£‡∏π‡πâ‡∏™‡∏∂‡∏Å '‡∏ä‡∏≠‡∏ö' ‡∏Å‡∏•‡∏¥‡πà‡∏ô‡∏ô‡∏µ‡πâ‡∏°‡∏≤‡∏Å ‡∏ô‡πâ‡∏≥‡∏•‡∏≤‡∏¢‡∏™‡∏≠ (‡∏™‡∏∏‡∏Ç‡πÄ‡∏ß‡∏ó‡∏ô‡∏≤)",
                    SOCIAL: "‡∏£‡∏π‡πâ‡∏™‡∏∂‡∏Å '‡πÑ‡∏°‡πà‡∏û‡∏≠‡πÉ‡∏à' ‡∏≠‡∏¢‡πà‡∏≤‡∏á‡πÅ‡∏£‡∏á ‡πÄ‡∏à‡πá‡∏ö‡πÉ‡∏à (‡∏ó‡∏∏‡∏Å‡∏Ç‡πå‡πÄ‡∏ß‡∏ó‡∏ô‡∏≤)",
                    SHOPPING: "‡∏£‡∏π‡πâ‡∏™‡∏∂‡∏Å '‡∏ñ‡∏π‡∏Å‡πÉ‡∏à' ‡∏ï‡∏∑‡πà‡∏ô‡πÄ‡∏ï‡πâ‡∏ô ‡∏≠‡∏¢‡∏≤‡∏Å‡πÑ‡∏î‡πâ (‡∏™‡∏∏‡∏Ç‡πÄ‡∏ß‡∏ó‡∏ô‡∏≤)",
                    CUSTOM: ""
                }
            },
            { 
                id: 8, pali: "‡∏ï‡∏±‡∏ì‡∏´‡∏≤", tech: "Recursive Loop", icon: "refresh-cw", 
                dhamma: "‡∏Ñ‡∏ß‡∏≤‡∏°‡∏ó‡∏∞‡∏¢‡∏≤‡∏ô‡∏≠‡∏¢‡∏≤‡∏Å (‡∏Å‡∏≤‡∏°/‡∏†‡∏ß/‡∏ß‡∏¥‡∏†‡∏ß)", 
                analogy: "‡πÄ‡∏´‡∏°‡∏∑‡∏≠‡∏ô Loop ‡πÇ‡∏õ‡∏£‡πÅ‡∏Å‡∏£‡∏°‡∏ó‡∏µ‡πà‡∏™‡∏±‡πà‡∏á‡∏£‡∏±‡∏ô‡∏ã‡πâ‡∏≥‡πÜ ‡πÑ‡∏°‡πà‡∏´‡∏¢‡∏∏‡∏î",
                scenarios: {
                    FOOD: "‡πÄ‡∏Å‡∏¥‡∏î‡∏Ñ‡∏ß‡∏≤‡∏°‡∏≠‡∏¢‡∏≤‡∏Å‡∏Å‡∏¥‡∏ô‡∏£‡∏∏‡∏ô‡πÅ‡∏£‡∏á ‡∏ï‡πâ‡∏≠‡∏á‡∏Å‡∏¥‡∏ô‡πÉ‡∏´‡πâ‡πÑ‡∏î‡πâ‡πÄ‡∏î‡∏µ‡πã‡∏¢‡∏ß‡∏ô‡∏µ‡πâ!",
                    SOCIAL: "‡πÄ‡∏Å‡∏¥‡∏î‡∏Ñ‡∏ß‡∏≤‡∏°‡∏≠‡∏¢‡∏≤‡∏Å‡∏î‡πà‡∏≤‡∏Å‡∏•‡∏±‡∏ö ‡∏≠‡∏¢‡∏≤‡∏Å‡πÄ‡∏≠‡∏≤‡∏ä‡∏ô‡∏∞ ‡∏≠‡∏¢‡∏≤‡∏Å‡πÉ‡∏´‡πâ‡∏°‡∏±‡∏ô‡πÄ‡∏à‡πá‡∏ö",
                    SHOPPING: "‡πÄ‡∏Å‡∏¥‡∏î‡∏Ñ‡∏ß‡∏≤‡∏°‡∏≠‡∏¢‡∏≤‡∏Å‡∏Ñ‡∏£‡∏≠‡∏ö‡∏Ñ‡∏£‡∏≠‡∏á ‡∏Ç‡∏≠‡∏á‡∏°‡∏±‡∏ô‡∏ï‡πâ‡∏≠‡∏á‡∏°‡∏µ ‡∏û‡∏•‡∏≤‡∏î‡πÑ‡∏°‡πà‡πÑ‡∏î‡πâ",
                    CUSTOM: ""
                }
            },
            { 
                id: 9, pali: "‡∏≠‡∏∏‡∏õ‡∏≤‡∏ó‡∏≤‡∏ô", tech: "File Ownership", icon: "lock", 
                dhamma: "‡∏Ñ‡∏ß‡∏≤‡∏°‡∏¢‡∏∂‡∏î‡∏°‡∏±‡πà‡∏ô‡∏ß‡πà‡∏≤‡πÄ‡∏õ‡πá‡∏ô '‡∏ï‡∏±‡∏ß‡∏Å‡∏π ‡∏Ç‡∏≠‡∏á‡∏Å‡∏π'", 
                analogy: "‡πÄ‡∏´‡∏°‡∏∑‡∏≠‡∏ô Lock File ‡πÑ‡∏ß‡πâ ‡∏´‡πâ‡∏≤‡∏°‡πÉ‡∏Ñ‡∏£‡πÅ‡∏ï‡∏∞‡∏ï‡πâ‡∏≠‡∏á",
                scenarios: {
                    FOOD: "‡∏¢‡∏∂‡∏î‡∏ß‡πà‡∏≤ '‡∏â‡∏±‡∏ô' ‡∏´‡∏¥‡∏ß, ‡∏ô‡∏µ‡πà‡∏Ñ‡∏∑‡∏≠‡∏≠‡∏≤‡∏´‡∏≤‡∏£ '‡∏Ç‡∏≠‡∏á‡∏â‡∏±‡∏ô' ‡πÉ‡∏Ñ‡∏£‡πÅ‡∏¢‡πà‡∏á‡πÑ‡∏°‡πà‡πÑ‡∏î‡πâ",
                    SOCIAL: "‡∏¢‡∏∂‡∏î‡∏ß‡πà‡∏≤ '‡∏ï‡∏±‡∏ß‡∏â‡∏±‡∏ô' ‡∏ñ‡∏π‡∏Å‡∏î‡πà‡∏≤ ‡∏®‡∏±‡∏Å‡∏î‡∏¥‡πå‡∏®‡∏£‡∏µ '‡∏Ç‡∏≠‡∏á‡∏â‡∏±‡∏ô' ‡∏ñ‡∏π‡∏Å‡∏´‡∏¢‡∏≤‡∏°",
                    SHOPPING: "‡∏¢‡∏∂‡∏î‡∏ß‡πà‡∏≤‡∏â‡∏±‡∏ô‡∏ï‡πâ‡∏≠‡∏á‡πÄ‡∏õ‡πá‡∏ô‡πÄ‡∏à‡πâ‡∏≤‡∏Ç‡∏≠‡∏á ‡∏à‡∏¥‡∏ô‡∏ï‡∏ô‡∏≤‡∏Å‡∏≤‡∏£‡∏ß‡πà‡∏≤‡πÉ‡∏™‡πà‡πÅ‡∏•‡πâ‡∏ß‡πÄ‡∏ó‡πà",
                    CUSTOM: ""
                }
            },
            { 
                id: 10, pali: "‡∏†‡∏û", tech: "Virtual Environment", icon: "database", 
                dhamma: "‡∏†‡∏≤‡∏ß‡∏∞‡∏ó‡∏µ‡πà‡∏à‡∏¥‡∏ï‡∏Å‡πà‡∏≠‡∏ï‡∏±‡∏ß (‡∏û‡∏§‡∏ï‡∏¥‡∏Å‡∏£‡∏£‡∏°)", 
                analogy: "‡πÄ‡∏´‡∏°‡∏∑‡∏≠‡∏ô‡∏™‡∏£‡πâ‡∏≤‡∏á‡πÇ‡∏•‡∏Å‡πÄ‡∏™‡∏°‡∏∑‡∏≠‡∏ô (Sandbox) ‡πÑ‡∏ß‡πâ‡∏£‡∏≠‡∏á‡∏£‡∏±‡∏ö",
                scenarios: {
                    FOOD: "‡∏à‡∏¥‡∏ï‡∏´‡∏°‡∏Å‡∏°‡∏∏‡πà‡∏ô‡∏≠‡∏¢‡∏π‡πà‡∏Å‡∏±‡∏ö‡∏Å‡∏≤‡∏£‡∏Å‡∏¥‡∏ô ‡∏Ç‡∏±‡∏ö‡∏£‡∏ñ‡πÑ‡∏õ‡∏£‡πâ‡∏≤‡∏ô ‡∏™‡∏±‡πà‡∏á‡∏≠‡∏≤‡∏´‡∏≤‡∏£",
                    SOCIAL: "‡∏ô‡∏¥‡πâ‡∏ß‡πÄ‡∏£‡∏¥‡πà‡∏°‡∏û‡∏¥‡∏°‡∏û‡πå‡∏î‡πà‡∏≤‡∏Å‡∏•‡∏±‡∏ö ‡πÉ‡∏à‡∏£‡πâ‡∏≠‡∏ô‡∏£‡∏∏‡πà‡∏°‡πÄ‡∏õ‡πá‡∏ô‡πÑ‡∏ü (‡∏ô‡∏£‡∏Å)",
                    SHOPPING: "‡∏Å‡∏î‡πÉ‡∏™‡πà‡∏ï‡∏∞‡∏Å‡∏£‡πâ‡∏≤ ‡πÄ‡∏ï‡∏£‡∏µ‡∏¢‡∏°‡∏£‡∏π‡∏î‡∏ö‡∏±‡∏ï‡∏£ ‡πÉ‡∏à‡πÑ‡∏õ‡∏≠‡∏¢‡∏π‡πà‡∏ó‡∏µ‡πà‡∏Ç‡∏≠‡∏á‡πÅ‡∏•‡πâ‡∏ß",
                    CUSTOM: ""
                }
            },
            { 
                id: 11, pali: "‡∏ä‡∏≤‡∏ï‡∏¥", tech: "Instance Running", icon: "play", 
                dhamma: "‡∏Å‡∏≤‡∏£‡πÄ‡∏Å‡∏¥‡∏î‡∏Ç‡∏≠‡∏á‡∏ï‡∏±‡∏ß‡∏ï‡∏ô‡∏ú‡∏π‡πâ‡πÄ‡∏™‡∏ß‡∏¢‡∏ú‡∏•", 
                analogy: "‡πÄ‡∏´‡∏°‡∏∑‡∏≠‡∏ô‡∏Å‡∏î Run ‡πÇ‡∏õ‡∏£‡πÅ‡∏Å‡∏£‡∏° ‡∏ï‡∏±‡∏ß‡∏•‡∏∞‡∏Ñ‡∏£‡πÄ‡∏£‡∏¥‡πà‡∏°‡πÄ‡∏•‡πà‡∏ô‡∏à‡∏£‡∏¥‡∏á",
                scenarios: {
                    FOOD: "‡∏•‡∏á‡∏°‡∏∑‡∏≠‡∏ó‡∏≤‡∏ô‡∏≠‡∏¢‡πà‡∏≤‡∏á‡πÄ‡∏≠‡∏£‡πá‡∏î‡∏≠‡∏£‡πà‡∏≠‡∏¢ (‡∏ï‡∏±‡∏ß‡∏Å‡∏¥‡∏ô‡πÄ‡∏Å‡∏¥‡∏î‡πÅ‡∏•‡πâ‡∏ß)",
                    SOCIAL: "‡πÇ‡∏û‡∏™‡∏ï‡πå‡∏î‡πà‡∏≤‡∏Å‡∏•‡∏±‡∏ö‡πÑ‡∏õ‡πÅ‡∏•‡πâ‡∏ß (‡∏ï‡∏±‡∏ß‡πÇ‡∏Å‡∏£‡∏ò‡∏ó‡∏≥‡∏á‡∏≤‡∏ô‡∏™‡∏°‡∏ö‡∏π‡∏£‡∏ì‡πå)",
                    SHOPPING: "‡∏à‡πà‡∏≤‡∏¢‡πÄ‡∏á‡∏¥‡∏ô ‡πÑ‡∏î‡πâ‡∏Ç‡∏≠‡∏á‡∏°‡∏≤‡∏ñ‡∏∑‡∏≠ (‡∏ï‡∏±‡∏ß‡πÄ‡∏à‡πâ‡∏≤‡∏Ç‡∏≠‡∏á‡πÄ‡∏Å‡∏¥‡∏î‡πÅ‡∏•‡πâ‡∏ß)",
                    CUSTOM: ""
                }
            },
            { 
                id: 12, pali: "‡∏ä‡∏£‡∏≤‡∏°‡∏£‡∏ì‡∏∞", tech: "System Crash", icon: "x-circle", 
                dhamma: "‡∏Ñ‡∏ß‡∏≤‡∏°‡πÄ‡∏™‡∏∑‡πà‡∏≠‡∏°‡∏™‡∏•‡∏≤‡∏¢‡πÅ‡∏•‡∏∞‡∏Ñ‡∏ß‡∏≤‡∏°‡∏ó‡∏∏‡∏Å‡∏Ç‡πå", 
                analogy: "‡πÄ‡∏´‡∏°‡∏∑‡∏≠‡∏ô‡πÄ‡∏Ñ‡∏£‡∏∑‡πà‡∏≠‡∏á‡∏£‡πâ‡∏≠‡∏ô System Crash ‡∏´‡∏£‡∏∑‡∏≠ Error",
                scenarios: {
                    FOOD: "‡∏≠‡∏¥‡πà‡∏°‡∏à‡∏ô‡∏≠‡∏∂‡∏î‡∏≠‡∏±‡∏î, ‡πÄ‡∏á‡∏¥‡∏ô‡∏´‡∏°‡∏î, ‡∏≠‡πâ‡∏ß‡∏ô‡∏Ç‡∏∂‡πâ‡∏ô, ‡∏´‡∏£‡∏∑‡∏≠‡∏≠‡∏≤‡∏´‡∏≤‡∏£‡∏´‡∏°‡∏î‡πÅ‡∏•‡πâ‡∏ß‡πÄ‡∏™‡∏µ‡∏¢‡∏î‡∏≤‡∏¢",
                    SOCIAL: "‡∏ó‡∏∞‡πÄ‡∏•‡∏≤‡∏∞‡∏Å‡∏±‡∏ô‡∏ö‡∏≤‡∏ô‡∏õ‡∏•‡∏≤‡∏¢, ‡πÄ‡∏™‡∏µ‡∏¢‡∏™‡∏∏‡∏Ç‡∏†‡∏≤‡∏û‡∏à‡∏¥‡∏ï, ‡πÇ‡∏î‡∏ô‡πÅ‡∏ö‡∏ô, ‡πÄ‡∏™‡∏µ‡∏¢‡πÉ‡∏à‡∏†‡∏≤‡∏¢‡∏´‡∏•‡∏±‡∏á",
                    SHOPPING: "‡πÄ‡∏á‡∏¥‡∏ô‡∏´‡∏°‡∏î, ‡∏Ç‡∏≠‡∏á‡∏ï‡∏Å‡∏£‡∏∏‡πà‡∏ô, ‡πÄ‡∏ö‡∏∑‡πà‡∏≠‡∏Ç‡∏≠‡∏á‡πÄ‡∏Å‡πà‡∏≤, ‡πÄ‡∏õ‡πá‡∏ô‡∏´‡∏ô‡∏µ‡πâ‡∏ö‡∏±‡∏ï‡∏£‡πÄ‡∏Ñ‡∏£‡∏î‡∏¥‡∏ï",
                    CUSTOM: ""
                }
            }
        ];

        const modeInfo = {
            'LOOP': { title: '‡πÇ‡∏´‡∏°‡∏î‡∏ß‡∏±‡∏è‡∏è‡∏∞ (Auto-Pilot)', desc: '‡∏ß‡∏±‡∏ï‡∏ñ‡∏∏‡∏õ‡∏£‡∏∞‡∏™‡∏á‡∏Ñ‡πå: ‡πÅ‡∏™‡∏î‡∏á‡πÉ‡∏´‡πâ‡πÄ‡∏´‡πá‡∏ô‡∏ß‡∏á‡∏à‡∏£‡∏õ‡∏Å‡∏ï‡∏¥‡∏Ç‡∏≠‡∏á‡∏à‡∏¥‡∏ï‡∏ó‡∏µ‡πà‡πÑ‡∏´‡∏•‡πÑ‡∏õ‡∏ï‡∏≤‡∏°‡∏Å‡∏¥‡πÄ‡∏•‡∏™ ‡∏™‡∏£‡πâ‡∏≤‡∏á‡∏ó‡∏∏‡∏Å‡∏Ç‡πå‡∏ß‡∏ô‡πÄ‡∏ß‡∏µ‡∏¢‡∏ô‡πÑ‡∏°‡πà‡∏£‡∏π‡πâ‡∏à‡∏ö', color: 'text-yellow-400', border: 'border-l-yellow-500' },
            'INTERNAL': { title: '‡πÇ‡∏´‡∏°‡∏î‡∏´‡∏¢‡∏∏‡∏î‡∏õ‡∏£‡∏∏‡∏á‡πÅ‡∏ï‡πà‡∏á (Stop Fabrication)', desc: '‡∏ß‡∏±‡∏ï‡∏ñ‡∏∏‡∏õ‡∏£‡∏∞‡∏™‡∏á‡∏Ñ‡πå: ‡πÄ‡∏û‡∏∑‡πà‡∏≠‡∏ù‡∏∂‡∏Å "‡∏ï‡∏±‡∏î‡∏Å‡∏£‡∏£‡∏°" ‡∏ó‡∏µ‡πà‡∏ï‡πâ‡∏ô‡πÄ‡∏´‡∏ï‡∏∏ ‡∏Ñ‡∏∑‡∏≠‡∏Å‡∏≤‡∏£‡∏£‡∏∞‡∏á‡∏±‡∏ö‡πÄ‡∏à‡∏ï‡∏ô‡∏≤‡∏õ‡∏£‡∏∏‡∏á‡πÅ‡∏ï‡πà‡∏á (‡∏™‡∏±‡∏á‡∏Ç‡∏≤‡∏£) ‡πÑ‡∏°‡πà‡πÉ‡∏´‡πâ‡∏™‡πà‡∏á‡∏ú‡∏•‡∏™‡∏∑‡∏ö‡πÄ‡∏ô‡∏∑‡πà‡∏≠‡∏á', color: 'text-orange-400', border: 'border-l-orange-500' },
            'GATEWAY': { title: '‡πÇ‡∏´‡∏°‡∏î‡∏™‡∏±‡∏Å‡πÅ‡∏ï‡πà‡∏ß‡πà‡∏≤‡∏£‡∏π‡πâ (Sense Restraint)', desc: '‡∏ß‡∏±‡∏ï‡∏ñ‡∏∏‡∏õ‡∏£‡∏∞‡∏™‡∏á‡∏Ñ‡πå: ‡πÄ‡∏û‡∏∑‡πà‡∏≠‡∏ù‡∏∂‡∏Å "‡∏™‡∏≥‡∏£‡∏ß‡∏°‡∏≠‡∏¥‡∏ô‡∏ó‡∏£‡∏µ‡∏¢‡πå" ‡∏õ‡πâ‡∏≠‡∏á‡∏Å‡∏±‡∏ô‡∏Ç‡πâ‡∏≠‡∏°‡∏π‡∏•‡∏Ç‡∏¢‡∏∞‡πÄ‡∏Ç‡πâ‡∏≤‡∏™‡∏π‡πà‡∏à‡∏¥‡∏ï ‡∏´‡∏¢‡∏∏‡∏î‡πÅ‡∏Ñ‡πà‡∏Å‡∏≤‡∏£‡πÄ‡∏´‡πá‡∏ô/‡πÑ‡∏î‡πâ‡∏¢‡∏¥‡∏ô (‡∏ú‡∏±‡∏™‡∏™‡∏∞)', color: 'text-cyan-400', border: 'border-l-cyan-500' },
            'VEDANA': { title: '‡πÇ‡∏´‡∏°‡∏î‡∏£‡∏π‡πâ‡∏ó‡∏±‡∏ô‡πÄ‡∏ß‡∏ó‡∏ô‡∏≤ (Mindfulness)', desc: '‡∏ß‡∏±‡∏ï‡∏ñ‡∏∏‡∏õ‡∏£‡∏∞‡∏™‡∏á‡∏Ñ‡πå: ‡πÄ‡∏û‡∏∑‡πà‡∏≠‡∏ù‡∏∂‡∏Å "‡∏≠‡∏∏‡πÄ‡∏ö‡∏Å‡∏Ç‡∏≤" ‡∏£‡∏π‡πâ‡∏ó‡∏±‡∏ô‡∏Ñ‡∏ß‡∏≤‡∏°‡∏£‡∏π‡πâ‡∏™‡∏∂‡∏Å‡∏™‡∏∏‡∏Ç/‡∏ó‡∏∏‡∏Å‡∏Ç‡πå ‡πÅ‡∏ï‡πà‡πÑ‡∏°‡πà‡∏´‡∏•‡∏á‡∏¢‡∏¥‡∏ô‡∏î‡∏µ‡∏´‡∏£‡∏∑‡∏≠‡∏¢‡∏¥‡∏ô‡∏£‡πâ‡∏≤‡∏¢‡πÑ‡∏õ‡∏Å‡∏±‡∏ö‡∏°‡∏±‡∏ô', color: 'text-purple-400', border: 'border-l-purple-500' },
            'TANHA': { title: '‡πÇ‡∏´‡∏°‡∏î‡∏î‡∏±‡∏ö‡∏ï‡∏±‡∏ì‡∏´‡∏≤ (Fading of Craving)', desc: '‡∏ß‡∏±‡∏ï‡∏ñ‡∏∏‡∏õ‡∏£‡∏∞‡∏™‡∏á‡∏Ñ‡πå: ‡πÄ‡∏û‡∏∑‡πà‡∏≠‡∏ù‡∏∂‡∏Å "‡∏ß‡∏¥‡∏£‡∏≤‡∏Ñ‡∏∞" ‡∏Ñ‡∏•‡∏≤‡∏¢‡∏Ñ‡∏ß‡∏≤‡∏°‡∏Å‡∏≥‡∏´‡∏ô‡∏±‡∏î ‡∏Ñ‡∏ß‡∏≤‡∏°‡∏≠‡∏¢‡∏≤‡∏Å‡πÑ‡∏î‡πâ/‡∏≠‡∏¢‡∏≤‡∏Å‡∏°‡∏µ ‡∏≠‡∏±‡∏ô‡πÄ‡∏õ‡πá‡∏ô‡πÄ‡∏´‡∏ï‡∏∏‡πÅ‡∏´‡πà‡∏á‡∏Å‡∏≤‡∏£‡∏¢‡∏∂‡∏î‡∏ï‡∏¥‡∏î', color: 'text-red-400', border: 'border-l-red-500' },
            'VOID': { title: '‡πÇ‡∏´‡∏°‡∏î‡∏™‡∏•‡∏±‡∏î‡∏Ñ‡∏∑‡∏ô (Total Release)', desc: '‡∏ß‡∏±‡∏ï‡∏ñ‡∏∏‡∏õ‡∏£‡∏∞‡∏™‡∏á‡∏Ñ‡πå: ‡πÄ‡∏û‡∏∑‡πà‡∏≠‡πÄ‡∏Ç‡πâ‡∏≤‡∏ñ‡∏∂‡∏á "‡∏™‡∏∏‡∏ç‡∏ç‡∏ï‡∏≤" (‡∏Ñ‡∏ß‡∏≤‡∏°‡∏ß‡πà‡∏≤‡∏á) ‡∏Ñ‡∏∑‡∏ô‡∏ò‡∏£‡∏£‡∏°‡∏ä‡∏≤‡∏ï‡∏¥‡∏ï‡∏≤‡∏°‡∏Ñ‡∏ß‡∏≤‡∏°‡πÄ‡∏õ‡πá‡∏ô‡∏à‡∏£‡∏¥‡∏á ‡πÑ‡∏°‡πà‡∏¢‡∏∂‡∏î‡∏ñ‡∏∑‡∏≠‡∏™‡∏¥‡πà‡∏á‡πÉ‡∏î‡∏ß‡πà‡∏≤‡πÄ‡∏õ‡πá‡∏ô‡πÄ‡∏£‡∏≤', color: 'text-white', border: 'border-l-white' }
        };

        const CREDIT_TEXT = `‡∏Ç‡∏≠‡∏Ç‡∏≠‡∏ö‡∏û‡∏£‡∏∞‡∏Ñ‡∏∏‡∏ì‡∏Ñ‡∏£‡∏π‡∏≠‡∏≤‡∏à‡∏≤‡∏£‡πå‡∏¢‡∏ó‡∏∏‡∏Å‡πÜ‡∏ó‡πà‡∏≤‡∏ô ‡∏ó‡∏µ‡πà‡πÄ‡∏ú‡∏¢‡πÅ‡∏û‡∏£‡πà‡∏ß‡∏¥‡∏ä‡∏≤‡∏Ñ‡∏ß‡∏≤‡∏°‡∏£‡∏π‡πâ‡πÉ‡∏´‡πâ‡πÄ‡∏Å‡∏¥‡∏î‡∏ã‡∏∂‡πà‡∏á‡∏õ‡∏±‡∏ç‡∏ç‡∏≤ ‡πÄ‡∏û‡∏∑‡πà‡∏≠‡πÉ‡∏´‡πâ‡∏ä‡∏µ‡∏ß‡∏¥‡∏ï‡∏ô‡∏µ‡πâ‡πÑ‡∏î‡πâ‡∏´‡∏•‡∏∏‡∏î‡∏û‡πâ‡∏ô‡∏à‡∏≤‡∏Å‡∏Ñ‡∏ß‡∏≤‡∏°‡∏ó‡∏∏‡∏Å‡∏Ç‡πå ‡∏´‡∏£‡∏∑‡∏≠ ‡∏´‡∏•‡∏∏‡∏î‡∏û‡πâ‡∏ô‡∏à‡∏≤‡∏Å‡∏ß‡∏±‡∏è‡∏à‡∏±‡∏Å‡∏£‡πÄ‡∏ß‡∏µ‡∏¢‡∏ô‡πÑ‡∏´‡∏ß‡πâ‡∏ï‡∏≤‡∏¢‡πÄ‡∏Å‡∏¥‡∏î ‡πÇ‡∏î‡∏¢‡∏Å‡∏≤‡∏£‡∏•‡∏∞‡∏Å‡∏¥‡πÄ‡∏•‡∏®‡πÉ‡∏´‡πâ‡πÑ‡∏î‡πâ‡∏°‡∏≤‡∏Å‡∏ó‡∏µ‡πà‡∏™‡∏∏‡∏î\n\n‡∏´‡∏≤‡∏Å‡∏°‡∏µ‡∏Ç‡πâ‡∏≠‡∏°‡∏π‡∏•‡πÄ‡∏ô‡∏∑‡πâ‡∏≠‡∏´‡∏≤‡πÉ‡∏î‡∏ú‡∏¥‡∏î‡∏û‡∏•‡∏≤‡∏î‡∏ï‡πâ‡∏≠‡∏á‡∏Ç‡∏≠‡∏≠‡∏†‡∏±‡∏¢‡∏°‡∏≤ ‡∏ì ‡∏ó‡∏µ‡πà‡∏ô‡∏µ‡πà‡∏î‡πâ‡∏ß‡∏¢\n\n‡∏™‡∏£‡πâ‡∏≤‡∏á‡∏™‡∏£‡∏£‡∏Ñ‡πå‡πÇ‡∏î‡∏¢ : ‡πÄ‡∏Å‡∏µ‡∏¢‡∏£‡∏ï‡∏¥‡∏®‡∏±‡∏Å‡∏î‡∏¥‡πå ‡∏ó‡∏µ‡∏õ‡∏ß‡πç‡πÇ‡∏™`;

        let currentMode = 'LOOP';
        let currentScenario = 'NONE';
        let idx = 0;
        const CYCLE_TIME = 4500;
        let startTime = Date.now();
        let fadeTimeout;

        function init() {
            const grid = document.getElementById('grid-container');
            grid.innerHTML = nidanas.map((n, i) => `
                <div id="card-${i}" onclick="jumpTo(${i})" class="zen-panel p-2 relative cursor-pointer transition-all duration-300 flex flex-col justify-between group h-full hover:bg-slate-800/50">
                    <div class="flex justify-between items-start opacity-70 group-hover:opacity-100 transition-opacity">
                        <span class="text-[9px] font-mono text-slate-500">0${n.id}</span>
                        <i data-lucide="${n.icon}" class="w-4 h-4 text-slate-500 icon-el transition-colors"></i>
                    </div>
                    <div class="mt-2 relative z-10">
                        <h3 class="text-xs md:text-sm font-bold text-slate-400 group-hover:text-white transition-colors title-text">${n.pali}</h3>
                        <div class="text-[8px] font-mono uppercase tracking-wider text-slate-600 mt-0.5">${n.tech}</div>
                    </div>
                    
                    <div class="absolute bottom-0 left-0 w-full h-[2px] bg-white/5">
                        <div id="prog-${i}" class="h-full w-0 transition-all duration-75"></div>
                    </div>
                    
                    <div id="cut-${i}" class="absolute top-2 right-2 opacity-0 transition-all duration-300 transform scale-50">
                        <span class="text-[8px] font-bold px-1.5 py-0.5 rounded bg-white/20 text-white backdrop-blur-md border border-white/20">CUT</span>
                    </div>
                </div>
            `).join('');
            lucide.createIcons();
            setMode('LOOP');
            animate();
        }

        function setMode(mode) {
            currentMode = mode;
            document.querySelectorAll('.nav-btn').forEach(b => b.classList.remove('active'));
            document.getElementById('btn-' + mode).classList.add('active');
            
            const dot = document.getElementById('mode-dot');
            const info = modeInfo[mode];
            dot.className = `w-2.5 h-2.5 rounded-full shadow-[0_0_10px_currentColor] transition-colors duration-500 ${info.color.replace('text-', 'bg-')}`;

            const box = document.getElementById('mode-info-box');
            box.className = `mode-info-container zen-panel border-l-4 p-3 shrink-0 ${info.border}`;
            box.classList.remove('collapsed');
            
            document.getElementById('mode-title').innerText = info.title;
            document.getElementById('mode-title').className = `text-sm font-bold mb-1 ${info.color}`;
            document.getElementById('mode-desc').innerText = info.desc;

            if(fadeTimeout) clearTimeout(fadeTimeout);
            fadeTimeout = setTimeout(() => {
                box.classList.add('collapsed');
            }, 10000); 

            idx = 0;
            startTime = Date.now();
            for(let j=0; j<12; j++) {
                const p = document.getElementById(`prog-${j}`);
                if(p) p.style.width = '0%';
            }
            updateUI();
        }

        function changeScenario(val) {
            currentScenario = val;
            updateUI();
        }

        function jumpTo(i) {
            if(currentMode === 'VOID') return;
            idx = i;
            startTime = Date.now();
            for(let j=0; j<12; j++) {
                const p = document.getElementById(`prog-${j}`);
                if(p) p.style.width = '0%';
            }
            updateUI();
        }

        function updateUI() {
            const activeData = nidanas[idx];
            const info = modeInfo[currentMode];
            const scenarioBox = document.getElementById('scenario-box');
            
            if (currentMode === 'VOID') {
                document.getElementById('active-pali').innerText = "‡∏™‡∏∏‡∏ç‡∏ç‡∏ï‡∏≤";
                document.getElementById('active-tech-label').innerText = "SYSTEM VOID";
                document.getElementById('label-dhamma').innerText = "‡∏Ñ‡∏ß‡∏≤‡∏°‡∏´‡∏°‡∏≤‡∏¢‡∏ó‡∏≤‡∏á‡∏ò‡∏£‡∏£‡∏°";
                document.getElementById('active-dhamma').innerText = "‡∏Ñ‡∏ß‡∏≤‡∏°‡∏ß‡πà‡∏≤‡∏á‡∏à‡∏≤‡∏Å‡∏ï‡∏±‡∏ß‡∏ï‡∏ô ‡∏Ñ‡∏ß‡∏≤‡∏°‡∏õ‡∏£‡∏∏‡∏á‡πÅ‡∏ï‡πà‡∏á‡∏î‡∏±‡∏ö‡∏™‡∏ô‡∏¥‡∏ó ‡∏Ñ‡∏∑‡∏ô‡∏™‡∏π‡πà‡∏ò‡∏£‡∏£‡∏°‡∏ä‡∏≤‡∏ï‡∏¥ ‡πÑ‡∏°‡πà‡∏°‡∏µ‡∏Å‡∏≤‡∏£‡πÄ‡∏Å‡∏¥‡∏î‡∏î‡∏±‡∏ö";
                
                document.getElementById('label-analogy').innerText = "‡∏Å‡∏¥‡∏ï‡∏ï‡∏¥‡∏Å‡∏£‡∏£‡∏°‡∏õ‡∏£‡∏∞‡∏Å‡∏≤‡∏®";
                document.getElementById('icon-analogy').setAttribute('data-lucide', 'heart-handshake');
                document.getElementById('active-analogy').innerText = CREDIT_TEXT;
                
                document.getElementById('bg-icon-decor').innerHTML = `<i data-lucide="wind" class="w-48 h-48 text-white"></i>`;
                document.getElementById('pid-display').innerText = "--";
                scenarioBox.classList.add('hidden');
            } else {
                document.getElementById('active-pali').innerText = activeData.pali;
                document.getElementById('active-pali').className = `text-3xl md:text-4xl font-bold transition-all duration-300 leading-tight ${info.color}`;
                document.getElementById('active-tech-label').innerText = activeData.tech;
                
                document.getElementById('label-dhamma').innerText = "‡∏Ñ‡∏ß‡∏≤‡∏°‡∏´‡∏°‡∏≤‡∏¢‡∏ó‡∏≤‡∏á‡∏ò‡∏£‡∏£‡∏°";
                document.getElementById('active-dhamma').innerText = activeData.dhamma;
                
                document.getElementById('label-analogy').innerText = "‡πÄ‡∏õ‡∏£‡∏µ‡∏¢‡∏ö‡πÄ‡∏ó‡∏µ‡∏¢‡∏ö‡∏ó‡∏≤‡∏á‡πÄ‡∏ó‡∏Ñ‡∏ô‡∏¥‡∏Ñ";
                document.getElementById('icon-analogy').setAttribute('data-lucide', 'monitor');
                document.getElementById('active-analogy').innerText = activeData.analogy;
                
                document.getElementById('bg-icon-decor').innerHTML = `<i data-lucide="${activeData.icon}" class="w-48 h-48 text-white"></i>`;
                document.getElementById('pid-display').innerText = (idx + 1).toString().padStart(2, '0') + "/12";

                // Scenario Logic
                if (currentScenario !== 'NONE') {
                    scenarioBox.classList.remove('hidden');
                    let label = "‡∏™‡∏ñ‡∏≤‡∏ô‡∏Å‡∏≤‡∏£‡∏ì‡πå‡∏ï‡∏±‡∏ß‡∏≠‡∏¢‡πà‡∏≤‡∏á";
                    let content = "...";
                    
                    if (currentScenario === 'CUSTOM' && activeData.scenarios.CUSTOM) {
                        label = "‡∏™‡∏ñ‡∏≤‡∏ô‡∏Å‡∏≤‡∏£‡∏ì‡πå‡∏Ç‡∏≠‡∏á‡∏Ñ‡∏∏‡∏ì";
                        content = activeData.scenarios.CUSTOM;
                    } else if (activeData.scenarios[currentScenario]) {
                        if(currentScenario === 'FOOD') label = "‡∏ï‡∏±‡∏ß‡∏≠‡∏¢‡πà‡∏≤‡∏á: ‡πÄ‡∏£‡∏∑‡πà‡∏≠‡∏á‡∏Å‡∏¥‡∏ô";
                        if(currentScenario === 'SOCIAL') label = "‡∏ï‡∏±‡∏ß‡∏≠‡∏¢‡πà‡∏≤‡∏á: ‡πÇ‡∏ã‡πÄ‡∏ä‡∏µ‡∏¢‡∏•";
                        if(currentScenario === 'SHOPPING') label = "‡∏ï‡∏±‡∏ß‡∏≠‡∏¢‡πà‡∏≤‡∏á: ‡∏ä‡πâ‡∏≠‡∏õ‡∏õ‡∏¥‡πâ‡∏á";
                        content = activeData.scenarios[currentScenario];
                    }
                    
                    document.getElementById('label-scenario').innerText = label;
                    document.getElementById('active-scenario').innerText = content;
                } else {
                    scenarioBox.classList.add('hidden');
                }
            }
            lucide.createIcons();

            nidanas.forEach((n, i) => {
                const card = document.getElementById(`card-${i}`);
                const title = card.querySelector('.title-text');
                const icon = card.querySelector('.icon-el');
                const cutBadge = document.getElementById(`cut-${i}`);
                const prog = document.getElementById(`prog-${i}`);

                card.classList.remove('zen-active', 'highlight-LOOP', 'highlight-INTERNAL', 'highlight-GATEWAY', 'highlight-VEDANA', 'highlight-TANHA', 'highlight-VOID');
                title.className = "text-xs md:text-sm font-bold text-slate-400 group-hover:text-white transition-colors title-text";
                icon.className = "w-4 h-4 text-slate-500 icon-el transition-colors";
                cutBadge.classList.add('opacity-0', 'scale-50');

                if (currentMode === 'VOID') {
                    card.style.opacity = "0.2";
                    return;
                }

                if (i === idx) {
                    card.classList.add('zen-active', `highlight-${currentMode}`);
                    title.className = `text-xs md:text-sm font-bold transition-colors title-text ${info.color}`;
                    icon.className = `w-4 h-4 icon-el transition-colors ${info.color}`;
                    card.style.opacity = "1";
                } else {
                    card.style.opacity = "0.75"; 
                    if(i !== idx) prog.style.width = '0%';
                }

                let showCut = false;
                if (currentMode === 'INTERNAL' && i === 1) showCut = true;
                if (currentMode === 'GATEWAY' && i === 5) showCut = true;
                if (currentMode === 'VEDANA' && i === 6) showCut = true;
                if (currentMode === 'TANHA' && i === 7) showCut = true;

                if (showCut) {
                    cutBadge.classList.remove('opacity-0', 'scale-50');
                    card.style.opacity = "0.9"; 
                }
            });
        }

        function animate() {
            if (currentMode === 'VOID') {
                 document.getElementById('main-progress').style.width = '0%';
                 requestAnimationFrame(animate);
                 return;
            }

            const now = Date.now();
            const elapsed = now - startTime;
            const progress = Math.min((elapsed / CYCLE_TIME) * 100, 100);
            const info = modeInfo[currentMode];

            const mainBar = document.getElementById('main-progress');
            mainBar.style.width = `${progress}%`;
            mainBar.className = `progress-bar ${info.color.replace('text-', 'bg-')}`;

            const cardBar = document.getElementById(`prog-${idx}`);
            if(cardBar) {
                cardBar.style.width = `${progress}%`;
                cardBar.className = `h-full transition-all duration-75 ${info.color.replace('text-', 'bg-')}`;
            }

            if (elapsed >= CYCLE_TIME) {
                const prevIdx = idx;
                if(document.getElementById(`prog-${prevIdx}`)) {
                    document.getElementById(`prog-${prevIdx}`).style.width = '0%';
                }

                idx = (idx + 1) % 12;

                if (currentMode === 'INTERNAL' && idx > 1) idx = 0;
                else if (currentMode === 'GATEWAY' && idx > 5) idx = 0;
                else if (currentMode === 'VEDANA' && idx > 6) idx = 0;
                else if (currentMode === 'TANHA' && idx > 7) idx = 0;

                startTime = Date.now();
                updateUI();
            }

            requestAnimationFrame(animate);
        }

        // --- AI Features ---
        function openAIModal() {
            document.getElementById('ai-modal').classList.add('open');
            document.getElementById('ai-input').focus();
        }

        function closeAIModal() {
            document.getElementById('ai-modal').classList.remove('open');
        }

        async function submitAI() {
            const input = document.getElementById('ai-input').value.trim();
            if (!input) return;

            const btn = document.getElementById('ai-submit-btn');
            btn.innerHTML = `<i data-lucide="loader" class="w-4 h-4 animate-spin"></i> ‡∏Å‡∏≥‡∏•‡∏±‡∏á‡∏ß‡∏¥‡πÄ‡∏Ñ‡∏£‡∏≤‡∏∞‡∏´‡πå...`;
            btn.disabled = true;

            try {
                // Call Gemini API
                const response = await fetch(`https://generativelanguage.googleapis.com/v1beta/models/gemini-2.5-flash-preview-09-2025:generateContent?key=${apiKey}`, {
                    method: 'POST',
                    headers: { 'Content-Type': 'application/json' },
                    body: JSON.stringify({
                        contents: [{
                            parts: [{
                                text: `You are an expert in Buddhist Paticcasamuppada (Dependent Origination). 
                                Analyze this user situation: "${input}". 
                                Map it to the 12 Nidanas. 
                                Return ONLY a JSON object where keys are "1" to "12" and values are short Thai descriptions (max 1-2 sentences) of how that node manifests in this situation. 
                                Example format: { "1": "‡∏Ñ‡∏≥‡∏≠‡∏ò‡∏¥‡∏ö‡∏≤‡∏¢...", "2": "..." }`
                            }]
                        }]
                    })
                });

                const data = await response.json();
                const text = data.candidates[0].content.parts[0].text;
                
                // Extract JSON from response
                const jsonMatch = text.match(/\{[\s\S]*\}/);
                if (jsonMatch) {
                    const result = JSON.parse(jsonMatch[0]);
                    
                    // Update Nidanas with Custom Scenario
                    nidanas.forEach(n => {
                        n.scenarios.CUSTOM = result[n.id] || "‡πÑ‡∏°‡πà‡∏°‡∏µ‡∏Ç‡πâ‡∏≠‡∏°‡∏π‡∏•";
                    });

                    // Select Custom Scenario
                    const select = document.getElementById('scenario-select');
                    select.querySelector('option[value="CUSTOM"]').hidden = false;
                    select.value = "CUSTOM";
                    changeScenario("CUSTOM");
                    
                    closeAIModal();
                } else {
                    throw new Error("Invalid JSON format");
                }

            } catch (error) {
                console.error("AI Error:", error);
                alert("‡πÄ‡∏Å‡∏¥‡∏î‡∏Ç‡πâ‡∏≠‡∏ú‡∏¥‡∏î‡∏û‡∏•‡∏≤‡∏î‡πÉ‡∏ô‡∏Å‡∏≤‡∏£‡πÄ‡∏ä‡∏∑‡πà‡∏≠‡∏°‡∏ï‡πà‡∏≠‡∏Å‡∏±‡∏ö AI ‡∏Å‡∏£‡∏∏‡∏ì‡∏≤‡∏•‡∏≠‡∏á‡πÉ‡∏´‡∏°‡πà (API Key ‡∏≠‡∏≤‡∏à‡πÑ‡∏°‡πà‡∏ñ‡∏π‡∏Å‡∏ï‡πâ‡∏≠‡∏á‡∏´‡∏£‡∏∑‡∏≠‡∏´‡∏°‡∏î‡∏≠‡∏≤‡∏¢‡∏∏)");
            } finally {
                btn.innerHTML = `<i data-lucide="brain-circuit" class="w-4 h-4"></i> ‡∏ß‡∏¥‡πÄ‡∏Ñ‡∏£‡∏≤‡∏∞‡∏´‡πå`;
                btn.disabled = false;
                lucide.createIcons();
            }
        }

        window.onload = init;
    </script>
</body>
</html>
